!function(t){"use strict";const e=window.wci_params||{};var n={styles_state:{desktop:{},mobile:{}},initializeStyles:function(){t(".design-control-input").each((function(){const e=t(this),i=e.val()?.trim()||"",o=e.data("device"),a=e.data("element"),s=e.data("property"),c=e.data("box-position")||"",l=e.closest(".design-control-group").find(".design-control-select").val()||"",r=c?`${s}-${c}`:s,d=i&&l?`${i}${l}`:i;i&&n.updateStyles(o,a,r,d)}))},activateTabs:function(){setTimeout((()=>{!function(){let e=localStorage.getItem("woo_custom_installments_active_tab_index");null===e?t('.woo-custom-installments-tab-wrapper a.nav-tab[href="#general"]').click():t(".woo-custom-installments-tab-wrapper a.nav-tab").eq(e).click()}()}),100),t(document).on("click",".woo-custom-installments-tab-wrapper a.nav-tab",(function(){let e=t(this).index();localStorage.setItem("woo_custom_installments_active_tab_index",e);let n=t(this).attr("href");return t(".woo-custom-installments-tab-wrapper a.nav-tab").removeClass("nav-tab-active"),t(".woo-custom-installments-form .nav-content").removeClass("active"),t(this).addClass("nav-tab-active"),t(".woo-custom-installments-form").find(n).addClass("active"),!1}))},saveSettings:function(){let i=t('form[name="woo-custom-installments"]'),o=i.serialize();t("#woo_custom_installments_save_options").on("click",(function(a){a.preventDefault();let s=t(this),c=n.keepButtonState(s);t.ajax({url:e.ajax_url,type:"POST",data:{action:"wci_save_options",form_data:i.serialize(),security:e.nonces.save_settings},beforeSend:function(){s.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){e.debug_mode&&console.log(t);try{"success"===t.status?(o=i.serialize(),n.displayToast("success",t.toast_header_title,t.toast_body_title),n.updateCustomInstallmentsLoop()):n.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(t){console.log(t)}},error:function(t,e,n){console.error("AJAX Error:",e,n)},complete:function(){s.html(c.html)}})})),i.on("change input","input, select, textarea",(function(){i.serialize()!==o?t("#woo_custom_installments_save_options").prop("disabled",!1):t("#woo_custom_installments_save_options").prop("disabled",!0)}))},keepButtonState:function(t){var e=t.width(),n=t.height(),i=t.html();return t.width(e),t.height(n),{width:e,height:n,html:i}},validateInputNumbers:function(){t(".allow-numbers-be-1, .allow-numbers-be-0").on("input",(function(){let e=t(this),n=parseFloat(e.val())||0,i=e.hasClass("allow-numbers-be-1")?1:0;n<i&&e.val(i)}))},hideToasts:function(){t(document).on("click",".hide-toast",(function(){t(".toast").fadeOut("fast")})),setTimeout((function(){t(".toast").fadeOut("fast")}),3e3)},updateStyles:function(t,e,n,i){n&&i&&(this.styles_state[t][e]||(this.styles_state[t][e]={}),this.styles_state[t][e][n]=i,this.updateCSS(t,e))},updateCSS:function(e,n){const i=`${e}-${n}-styles`;t(`#${i}`).remove();const o={...this.styles_state[e][n]},a={};["margin","padding","border-radius"].forEach((t=>{const e=o[`${t}-top`]||"0",n=o[`${t}-right`]||"0",i=o[`${t}-bottom`]||"0",s=o[`${t}-left`]||"0";(e||n||i||s)&&(a[t]=`${e} ${n} ${i} ${s}`),delete o[`${t}-top`],delete o[`${t}-right`],delete o[`${t}-bottom`],delete o[`${t}-left`]})),Object.assign(o,a);const s=Object.entries(o).map((([t,e])=>`${t}: ${e} !important;`)).join(" ");s&&t("<style>",{id:i,text:`.preview.${n}[data-device="${e}"] { ${s} }`}).appendTo("head")},updateCustomInstallmentsLoop:function(){let e=parseInt(t("#max_qtd_installments").val()),n="";for(let i=parseInt(t("#max_qtd_installments_without_fee").val())+1;i<=e;i++){n+=`<div class="input-group mb-2" data-installment="${i}">`,n+=`<input class="custom-installment-first small-input form-control" type="text" disabled value="${i}"/>`,n+=`<input class="custom-installment-secondary small-input form-control allow-number-and-dots" type="text" placeholder="1.0" name="custom_fee_installments[${i}][amount]" id="custom_fee_installments[${i}]" value="${parseFloat(t(`input[name="custom_fee_installments[${i}][amount]"]`).val())||0}" />`,n+="</div>"}t("#custom-installments-fieldset-custom-installments").html(n)},changeVisibility:function(e,i){let o=t(e).prop("checked");t(i).toggleClass("d-none",!o),t(e).click((function(){n.changeVisibility(t(this),i)})),n.updatePaymentFormsVisibility()},updatePaymentFormsVisibility:function(){let e=t("#enable_pix_method_payment_form").prop("checked")||t("#enable_ticket_method_payment_form").prop("checked")||t("#enable_credit_card_method_payment_form").prop("checked")||t("#enable_debit_card_method_payment_form").prop("checked");t(".container-separator.payment-forms").toggleClass("d-none",!e)},changeSymbolIcon:function(t,n){let i=t.val();"percentage"===i?n.html("%"):"fixed"===i&&n.html(e.currency_symbol)},changeSymbolDiscounts:function(t){let e=t.find(".get-discount-method-payment-method"),i=t.find(".discount-method-result-payment-method");e.change((function(){n.changeSymbolIcon(e,i)})),n.changeSymbolIcon(e,i)},changeSymbolInterests:function(t){let e=t.find(".get-interest-method-payment-method"),i=t.find(".interest-method-result-payment-method");e.change((function(){n.changeSymbolIcon(e,i)})),n.changeSymbolIcon(e,i)},refreshStylesForElement:function(e,n){this.styles_state[e][n]||(this.styles_state[e][n]={}),t(`.design-control-input[data-device="${e}"][data-element="${n}"]`).each(((i,o)=>{const a=t(o),s=a.val().trim(),c=a.data("property"),l=a.data("box-position")||"",r=a.closest(".design-control-group").find(".design-control-select").val()||"",d=l?`${c}-${l}`:c,u=s&&r?`${s}${r}`:s;s&&(this.styles_state[e][n][d]=u)})),this.updateCSS(e,n)},bindStyleEvents:function(){const e=this;t(document).on("input change keyup",".design-control-input",(function(){const n=t(this),i=n.data("device"),o=n.data("element");e.refreshStylesForElement(i,o)})),t(document).on("change",".design-control-select",(function(){const n=t(this),i=n.data("device"),o=n.data("element");e.refreshStylesForElement(i,o)})),t(document).on("input change",".set-font-weight, .set-font-color, .set-background-color, .set-font-size-unit",(function(){const n=t(this),i=n.data("device"),o=n.data("element"),a=n.data("property"),s=n.val();e.updateStyles(i,o,a,s),e.refreshStylesForElement(i,o)})),t(document).on("click",".design-device-wrapper .nav-tab",(function(){const e=t(this),n=e.data("device");e.siblings(".nav-tab").removeClass("nav-tab-active"),e.addClass("nav-tab-active"),t(".design-device-content .nav-content").removeClass("show"),t(`.design-device-content .nav-content[data-device="${n}"]`).addClass("show")}))},displayToast:function(n,i,o){"error"===n&&(n="danger");const a=`<div class="toast toast-${n} show">\n\t\t\t\t<div class="toast-header bg-${n} text-white">\n\t\t\t\t\t<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>\n\t\t\t\t\t<span class="me-auto">${i}</span>\n\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" aria-label="${e.i18n.aria_label_modal}"></button>\n\t\t\t\t</div>\n\t\t\t\t<div class="toast-body">${o}</div>\n\t\t\t</div>`;t(".woo-custom-installments-tab-wrapper").before(a),setTimeout((()=>{t(`.toast-${n}`).fadeOut("fast",(function(){t(this).remove()}))}),3e3)},displayModal:function(t,e,n){t.on("click",(function(t){t.preventDefault(),e.addClass("show")})),e.on("click",(function(t){t.target===this&&e.removeClass("show")})),n.on("click",(function(t){t.preventDefault(),e.removeClass("show")}))},initializeModals:function(){n.displayModal(t(".manage-credit-card-trigger"),t(".manage-credit-card-container"),t(".close-manage-credit-card")),n.displayModal(t(".manage-debit-card-trigger"),t(".manage-debit-card-container"),t(".close-manage-debit-card")),n.displayModal(t("#discount_per_quantity_trigger"),t("#discount_per_quantity_container"),t("#discount_per_quantity_close")),n.displayModal(t("#set_custom_fee_trigger"),t("#set_custom_fee_container"),t("#set_custom_fee_close")),n.displayModal(t("#wci_reset_settings_trigger"),t("#wci_reset_settings_container"),t("#wci_close_reset")),n.displayModal(t("#remove_price_range_settings_trigger"),t("#remove_price_range_settings_container"),t("#remove_price_range_settings_close")),n.displayModal(t("#custom_product_price_trigger"),t("#custom_product_price_container"),t("#custom_product_price_close")),n.displayModal(t("#center_group_elements_trigger"),t("#center_group_elements_container"),t("#center_group_elements_close")),t(".edit-elements-design").each((function(){let e=t("#"+t(this).find(".modal-trigger").attr("id")),i=t("#"+t(this).find(".popup-container").attr("id")),o=t("#"+t(this).find(".popup-container").find(".btn-close").attr("id"));n.displayModal(e,i,o)}))},changeIconClass:function(){t(".set-icon-class").on("input change keyup paste",(function(){const e=t(this).val();t(this).closest(".icon-class-container").find(".icon-preview").removeClass().addClass(`icon-preview fs-4 ${e}`),t(this).closest(".popup-content").find(".preview i").removeClass().addClass(`me-1 ${e}`),t(".popup-container.show").parent("div").siblings(".preview").children("i").removeClass().addClass(`me-1 ${e}`)}))},sortableElements:function(){!function(){let e=t("#reorder_wci_elements ul.sortable"),n=e.children("li");n.sort(((e,n)=>parseInt(t(e).find("input.change-priority").val())-parseInt(t(n).find("input.change-priority").val()))),n.detach().appendTo(e)}(),t("#reorder_wci_elements .sortable").sortable({handle:".handle",update:function(e,n){t(n.item).closest("ul").children("li").each((function(e){t(this).find("input.change-priority").val(e+1).change()}))}}),t(".tab-item .handle").on("mousedown",(function(e){1===e.which&&t(this).addClass("grabbing")})),t(".tab-item .handle").on("mouseup",(function(){t(this).removeClass("grabbing")})),t(document).on("mouseup",(function(){t(".tab-item .handle").removeClass("grabbing")}))},handleIconImage:function(){let n;t(".get-icon-image").on("click",(function(i){i.preventDefault();const o=t(this);n||(n=wp.media({title:e.i18n.set_media_title,button:{text:e.i18n.use_this_media_title},multiple:!1}),n.on("select",(function(){const t=n.state().get("selection").first().toJSON();o.siblings(".set-icon-image").val(t.url).trigger("change"),o.siblings(".input-group-text").find(".icon-preview").attr("src",t.url)}))),n.open()}))},toggleIconFormatContainers:function(){"class"===e.check_format_icons?(t(".icon-image-container").addClass("d-none"),t(".icon-class-container").removeClass("d-none")):(t(".icon-class-container").addClass("d-none"),t(".icon-image-container").removeClass("d-none")),t("#icon_format_elements").change((function(){"class"===t(this).val()?(t(".icon-image-container").addClass("d-none"),t(".icon-class-container").removeClass("d-none")):(t(".icon-class-container").addClass("d-none"),t(".icon-image-container").removeClass("d-none"))}))},resetPluginSettings:function(){t(document).on("click","#confirm_reset_settings",(function(i){if(i.preventDefault(),!confirm(e.i18n.confirm_reset_settings))return;let o=t(this),a=n.keepButtonState(o);t.ajax({url:e.ajax_url,type:"POST",data:{action:"reset_plugin_action"},beforeSend:function(){o.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(o.prop("disabled",!1).html(a.html),t("#wci_close_reset").click(),n.displayToast("success",e.toast_header_title,e.toast_body_title),setTimeout((()=>location.reload()),1e3)):n.displayToast("danger",e.toast_header_title,e.toast_body_title)}catch(t){console.log(t)}finally{o.prop("disabled",!1).html(a.html)}},error:function(t,e,n){console.error("AJAX Error:",e,n)},complete:function(){o.prop("disabled",!1).html(a.html)}})}))},detectOfflineConnection:function(){function i(){navigator.onLine?t(".toast-offline-connection").remove():n.displayToast("warning",e.i18n.offline_toast_header,e.i18n.offline_toast_body)}i(),window.addEventListener("online",i),window.addEventListener("offline",i)},selectVisibilityController:function(e,n,i){t(document).off("change",e),t(document).on("change",e,(function(){var o=t(e).val();n.includes(o)?t(i).removeClass("d-none"):t(i).addClass("d-none")}));var o=t(e).val();n.includes(o)?t(i).removeClass("d-none"):t(i).addClass("d-none")},initializeVisibilityControllers:function(){n.changeVisibility("#remove_price_range",".starting-from, .remove-price-range-dep"),n.changeVisibility("#enable_all_interest_options",".display-enable-all-interest-options"),n.changeVisibility("#enable_all_discount_options",".display-enable-all-discount-options"),n.changeVisibility("#enable_pix_method_payment_form",".admin-container-transfers"),n.changeVisibility("#enable_ticket_method_payment_form",".admin-container-ticket"),n.changeVisibility("#enable_credit_card_method_payment_form",".admin-container-credit-card"),n.changeVisibility("#enable_debit_card_method_payment_form",".admin-container-debit-card"),n.changeVisibility("#enable_functions_discount_per_quantity",".discount-per-quantity-option"),n.changeVisibility("#custom_text_after_price",".tr-custom-text-after-price"),n.changeVisibility("#enable_ticket_method_payment_form",".admin-discount-ticket-option"),n.changeVisibility("#enable_economy_pix_badge",".economy-pix-dependency"),n.selectVisibilityController("#hook_payment_form_single_product",["custom_hook"],".requires-custom-hook"),n.changeVisibility("#remove_price_range",".require-remove-price-range"),n.changeVisibility("#custom_text_after_price",".require-custom-product-price"),n.changeVisibility("#add_discount_custom_product_price",".require-add-discount-custom-product-price"),n.changeVisibility("#center_group_elements_loop",".require-center-group-elements")},colorSelector:function(){t(".input-color").each((function(){t(this).minicolors({control:t(this).attr("data-control")||"hue",defaultValue:t(this).attr("data-defaultValue")||"",format:t(this).attr("data-format")||"hex",keywords:t(this).attr("data-keywords")||"",inline:"true"===t(this).attr("data-inline"),letterCase:t(this).attr("data-letterCase")||"lowercase",opacity:t(this).attr("data-opacity"),position:t(this).attr("data-position")||"bottom",swatches:t(this).attr("data-swatches")?t(this).attr("data-swatches").split("|"):[],change:function(t,e){t&&e&&(t+=", "+e)},theme:"bootstrap"})})),t(".reset-color").on("click",(function(e){e.preventDefault();var n=t(this).data("color");t(this).closest(".color-container").find(".input-color").minicolors("value",n)}))},requireLicenseInfo:function(){n.displayModal(t(".pro-version-notice"),t("#popup-pro-notice"),t("#close-pro-notice")),t("#active_license_form").on("click",(function(e){e.preventDefault(),t("#popup-pro-notice").removeClass("show"),t('a.nav-tab[href="#about"]').click(),t("html, body").animate({scrollTop:t("#enable_auto_updates").offset().top},300)}))},init:function(){this.activateTabs(),this.saveSettings(),this.validateInputNumbers(),this.hideToasts(),this.updateCustomInstallmentsLoop(),this.updatePaymentFormsVisibility(),this.changeIconClass(),this.handleIconImage(),this.toggleIconFormatContainers(),this.sortableElements(),this.resetPluginSettings(),this.detectOfflineConnection(),this.initializeStyles(),this.bindStyleEvents(),this.initializeModals(),this.initializeVisibilityControllers(),this.colorSelector(),this.requireLicenseInfo()}};t(document).ready((function(){n.init()}))}(jQuery);